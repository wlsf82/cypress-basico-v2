# Lidando com links que abrem em outra aba

Na [p√°gina de _trade-offs_](https://docs.cypress.io/guides/references/trade-offs) da documenta√ß√£o oficial do Cypress (no momento da escrita desta aula), h√° uma se√ß√£o que comenta da limita√ß√£o do [Cypress funcionar somente em uma aba do navegador](https://docs.cypress.io/guides/references/trade-offs#Multiple-tabs).

Muitos v√™em isso como uma limita√ß√£o e n√£o buscam entender como contornar tal situa√ß√£o.

Por√©m, dependendo do que voc√™ precisa testar, isso n√£o seja t√£o dif√≠cil quanto voc√™ pensa.

Na aplica√ß√£o CAC TAT, temos um link para a pol√≠tica de privacidade, o qual quando clicado, abre tal p√°gina em uma nova aba do navegador.

Como testar tal p√°gina?

Ou, que outras alternativas tenho √† minha disposi√ß√£o?

Vou te apresentar duas alternativas, por√©m, na documenta√ß√£o oficial, voc√™ vai encontrar ainda mais.

## Alternativa 1 - confie que o navegador funciona (teste a aplica√ß√£o, n√£o o _browser_)

Ou seja, se um elemento do tipo √¢ncora (`a`) possui o atributo `target` com o valor `_blank`, quando clicado, obrigat√≥riamente o valor do atributo `href` ser√° aberto em uma nova aba. Este √© o compartamento padr√£o em qualquer navegador.

Neste caso, podemos simplesmente verificar tal caracter√≠stica, sem nem mesmo precisar clicar no elemento.

Algo como o seguinte:

`cy.get('.some-link').should('have.attr', 'target', '_blank')`

## Alternativa 2 - remova o atributo `target` do elemento

J√° se voc√™ precisa ir para esta outra p√°gina, o Cypress deixa voc√™ remover a propriedade `target` do elemento √¢ncora.

Para isso, te apresento a funcionalidade [`.invoke()`](https://docs.cypress.io/api/commands/invoke).

Com a funcionalidade `invoke()`, voc√™ pode fazer o seguinte, por exemplo: `cy.get('#link-que-abre-em-outra-aba').invoke('removeAttr', 'target')`.

> üë®‚Äçüè´ Vale comentar que, para tal alternativa funcionar, a p√°gina que normalmente abre em outra aba deve estar no mesmo dom√≠nio (ou sub-dom√≠nio) da aplica√ß√£o em teste.
>
> Para mais informa√ß√µes sobre como lidar com links que abrem em outras abas, consulte [esta p√°gina](https://github.com/cypress-io/cypress-example-recipes/tree/master/examples/testing-dom__tab-handling-links#tab-handling-anchor-links) (mantida pelo time do Cypress), a qual cont√©m recursos bastante √∫teis.

## Exerc√≠cio

1. Crie um teste chamado `verifica que a pol√≠tica de privacidade abre em outra aba sem a necessidade de um clique`
2. Tal teste deve utilizar a alternativa 1 demonstrada acima
3. Por fim, execute o novo teste no _Test Runner_, e quando o mesmo estiver passando, siga adiante para o pr√≥ximo exerc√≠cio

## Exerc√≠cio extra 1

1. Crie um testes chamado `acessa a p√°gina da pol√≠tica de privacidade removendo o target e ent√£o clicando no link`
2. Tal teste deve utilizar a alternativa 2 demonstrada acima
3. Por fim, execute o novo teste no _Test Runner_, e quando o mesmo estiver passando, siga adiante para o pr√≥ximo exerc√≠cio

## Exerc√≠cio extra 2 - Desafio

1. Crie um testes chamado `testa a p√°gina da pol√≠tica de privacidade de forma independente`
2. Use sua criativade e as funcionalidades que aprendeu at√© aqui para realizar este teste (a solu√ß√£o √© mais simples do que voc√™ imagina)
3. Por fim, execute o novo teste no _Test Runner_ e siga adiante somente quando o teste estiver passando

___

Siga para a [aula 8](./08.md) para aprender como rodar os testes simulando o _viewport_ de um dispositivo m√≥vel.
